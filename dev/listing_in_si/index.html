<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Remove the page category from the search index and make everything a section · GSoC Documentation</title><meta name="title" content="Remove the page category from the search index and make everything a section · GSoC Documentation"/><meta property="og:title" content="Remove the page category from the search index and make everything a section · GSoC Documentation"/><meta property="twitter:title" content="Remove the page category from the search index and make everything a section · GSoC Documentation"/><meta name="description" content="Documentation for GSoC Documentation."/><meta property="og:description" content="Documentation for GSoC Documentation."/><meta property="twitter:description" content="Documentation for GSoC Documentation."/><meta property="og:url" content="https://rahban1.github.io/gsoc-documenter/listing_in_si/"/><meta property="twitter:url" content="https://rahban1.github.io/gsoc-documenter/listing_in_si/"/><link rel="canonical" href="https://rahban1.github.io/gsoc-documenter/listing_in_si/"/><script async src="https://www.googletagmanager.com/gtag/js?id=UA-XXXXXXXXX-X"></script><script>  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'UA-XXXXXXXXX-X', {'page_path': location.pathname + location.search + location.hash});
</script><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../"><img src="../assets/logo.png" alt="GSoC Documentation logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../">GSoC Documentation</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><span class="tocitem">Deliverable Summary</span><ul><li><a class="tocitem" href="../adding_search_benchmarks/">Adding Search Benchmarks</a></li><li><a class="tocitem" href="../creating_test_manual/">Creating test manual and testing it on benchmarks</a></li><li><a class="tocitem" href="../improving_tokenizer/">Updating Tokenizer</a></li><li><a class="tocitem" href="../warn_when_si_big/">Warn when the search index is too big</a></li><li class="is-active"><a class="tocitem" href>Remove the page category from the search index and make everything a section</a><ul class="internal"><li><a class="tocitem" href="#Relevant-PR-:-[#2762](https://github.com/JuliaDocs/Documenter.jl/pull/2762)"><span>Relevant PR : #2762</span></a></li><li><a class="tocitem" href="#TL;DR"><span>TL;DR</span></a></li><li><a class="tocitem" href="#Idea"><span>Idea</span></a></li><li><a class="tocitem" href="#Implementation"><span>Implementation</span></a></li></ul></li><li><a class="tocitem" href="../dev_docs_for_search/">Documenter.jl Search System Developer Documentation</a></li></ul></li><li><span class="tocitem">Additionals</span><ul><li><a class="tocitem" href="../key_bindings/">Navigate the Search Results using up and down keys</a></li></ul></li><li><a class="tocitem" href="../conclusion/">Conclusion</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Deliverable Summary</a></li><li class="is-active"><a href>Remove the page category from the search index and make everything a section</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Remove the page category from the search index and make everything a section</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/Rahban1/gsoc-documenter" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/Rahban1/gsoc-documenter/blob/main/docs/src/listing_in_si.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Remove-the-page-category-from-the-search-index-and-make-everything-a-section"><a class="docs-heading-anchor" href="#Remove-the-page-category-from-the-search-index-and-make-everything-a-section">Remove the page category from the search index and make everything a section</a><a id="Remove-the-page-category-from-the-search-index-and-make-everything-a-section-1"></a><a class="docs-heading-anchor-permalink" href="#Remove-the-page-category-from-the-search-index-and-make-everything-a-section" title="Permalink"></a></h1><h2 id="Relevant-PR-:-[#2762](https://github.com/JuliaDocs/Documenter.jl/pull/2762)"><a class="docs-heading-anchor" href="#Relevant-PR-:-[#2762](https://github.com/JuliaDocs/Documenter.jl/pull/2762)">Relevant PR : <a href="https://github.com/JuliaDocs/Documenter.jl/pull/2762">#2762</a></a><a id="Relevant-PR-:-[#2762](https://github.com/JuliaDocs/Documenter.jl/pull/2762)-1"></a><a class="docs-heading-anchor-permalink" href="#Relevant-PR-:-[#2762](https://github.com/JuliaDocs/Documenter.jl/pull/2762)" title="Permalink"></a></h2><h2 id="TL;DR"><a class="docs-heading-anchor" href="#TL;DR">TL;DR</a><a id="TL;DR-1"></a><a class="docs-heading-anchor-permalink" href="#TL;DR" title="Permalink"></a></h2><p>This PR removes page categories from the search index and concatenates everything into sections instead. The changes modify how the documentation search functionality organizes content - rather than maintaining separate page categories, all content is now structured as sections within the search index. This appears to be part of a search index overhaul to simplify the organization structure.</p><h2 id="Idea"><a class="docs-heading-anchor" href="#Idea">Idea</a><a id="Idea-1"></a><a class="docs-heading-anchor-permalink" href="#Idea" title="Permalink"></a></h2><p>My mentors suggested that the search index size will reduce a lot and the search results will be much better if we could just remove the page category and make everything a section. The biggest blocker in this was what about the text that does not come in any section like the text before any section and the text at the end of the page which does not have any section</p><h2 id="Implementation"><a class="docs-heading-anchor" href="#Implementation">Implementation</a><a id="Implementation-1"></a><a class="docs-heading-anchor-permalink" href="#Implementation" title="Permalink"></a></h2><h3 id="Creating-struct"><a class="docs-heading-anchor" href="#Creating-struct">Creating struct</a><a id="Creating-struct-1"></a><a class="docs-heading-anchor-permalink" href="#Creating-struct" title="Permalink"></a></h3><pre><code class="language-Julia hljs"># Content segment for grouping content by sections
struct ContentSegment
    section_header::Union{Node, Nothing}  # AnchoredHeader node or nothing for default section
    content_nodes::Vector{Node}           # Content nodes belonging to this section
end</code></pre><h3 id="Creating-functions"><a class="docs-heading-anchor" href="#Creating-functions">Creating functions</a><a id="Creating-functions-1"></a><a class="docs-heading-anchor-permalink" href="#Creating-functions" title="Permalink"></a></h3><p>I added two functions to implement this approach </p><ul><li>First function is <code>segment_page_by_sections()</code>   It breaks page content into segments based on section headers.</li></ul><pre><code class="language-Julia hljs"># Segment page content by sections for improved search indexing
function segment_page_by_sections(page_mdast::Node)
    segments = ContentSegment[]
    current_segment_content = Node[]
    current_section_header = nothing

    for node in page_mdast.children
        if node.element isa Documenter.AnchoredHeader
            # Save previous segment if it has content or a header
            if !isempty(current_segment_content) || current_section_header !== nothing
                push!(segments, ContentSegment(current_section_header, copy(current_segment_content)))
            end
            # Start new section
            current_section_header = node
            current_segment_content = Node[]
        else
            # Skip nodes that shouldn&#39;t be indexed
            if !(node.element isa _SEARCHRECORD_IGNORED_BLOCK_TYPES)
                push!(current_segment_content, node)
            end
        end
    end

    # Add final segment
    if !isempty(current_segment_content) || current_section_header !== nothing
        push!(segments, ContentSegment(current_section_header, current_segment_content))
    end

    return segments
end</code></pre><ul><li>Second function is <code>create_segment_search_record()</code>    It creates search record for each content segment</li></ul><pre><code class="language-Julia hljs"># Create search record for a content segment
function create_segment_search_record(ctx::HTMLContext, navnode::Documenter.NavNode, segment::ContentSegment)
    if segment.section_header === nothing
        # Default section - use page title and aggregate content
        page_title = mdflatten_pagetitle(DCtx(ctx, navnode))
        content_text = isempty(segment.content_nodes) ? &quot;&quot; :
            join([mdflatten(node) for node in segment.content_nodes], &quot;\n\n&quot;)

        return SearchRecord(
            pretty_url(ctx, get_url(ctx, navnode.page)),
            getpage(ctx, navnode),
            &quot;&quot;,  # no fragment for default section
            &quot;section&quot;,  # changed from &quot;page&quot; to &quot;section&quot;
            page_title,
            page_title,
            content_text
        )
    else
        # Named section
        a = segment.section_header.element.anchor
        section_title = mdflatten(segment.section_header)
        content_text = isempty(segment.content_nodes) ? &quot;&quot; :
            join([mdflatten(node) for node in segment.content_nodes], &quot;\n\n&quot;)

        return SearchRecord(
            pretty_url(ctx, get_url(ctx, navnode.page)),
            getpage(ctx, navnode),
            Documenter.anchor_fragment(a),
            &quot;section&quot;,
            section_title,
            mdflatten_pagetitle(DCtx(ctx, navnode)),
            content_text
        )
    end
end</code></pre><p>and then in the domify function, iteratively create search records for each segment</p><pre><code class="language-Julia hljs">function domify(dctx::DCtx)
    ctx, navnode = dctx.ctx, dctx.navnode
    page_mdast = getpage(ctx, navnode).mdast

    # Generate search index using new segmentation approach
    segments = segment_page_by_sections(page_mdast)
    for segment in segments
        search_record = create_segment_search_record(ctx, navnode, segment)
        push!(ctx.search_index, search_record)
    end

    # Generate HTML as before - process each child node individually
    return map(page_mdast.children) do node
        domify(dctx, node, node.element)
    end
end</code></pre><p>What we are essentially doing here is concatenating all the content nodes in a single section and joing it with the header to create the <code>ContentSegment</code> struct</p><p>earlier the search index looked like this </p><p><img src="../assets/first.png" alt="before"/></p><p>now it looks like this :</p><p><img src="../assets/second.png" alt="after"/></p><p>these are some before and after results. Thank you Morten for sharing this :) <img src="../assets/4.png" alt="fourth"/> <img src="../assets/1.png" alt="first"/> <img src="../assets/2.png" alt="second"/> <img src="../assets/3.png" alt="third"/></p><p>There is considerable improvement in the size of the search index and relevance of search results.</p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../warn_when_si_big/">« Warn when the search index is too big</a><a class="docs-footer-nextpage" href="../dev_docs_for_search/">Documenter.jl Search System Developer Documentation »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="auto">Automatic (OS)</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.2.1 on <span class="colophon-date" title="Thursday 28 August 2025 19:24">Thursday 28 August 2025</span>. Using Julia version 1.11.6.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
